{
  "hash": "fcd35258c3a353ee56a4c2a1953ccec2",
  "result": {
    "markdown": "# Macro's {#sec-macros}\n\n\n\n\n\n::: callout\n**Doelstellingen**\n\n-   Uitleg macro's en het gebruik ervan.\n-   Activeren tabblad Ontwikkelaars.\n-   Opnemen van een macro met de macrorecorder.\n-   Wijzigen van een macro.\n-   Opdrachtknop maken.\n-   Beveiligingsinstellingen.\n:::\n\nEen taak die je in Microsoft Excel regelmatig moet uitvoeren kun je met een macro automatiseren. Een macro bestaat uit een reeks opdrachten en functies die door één commando of druk op een knop achter elkaar worden uitgevoerd.\n\nEen macro is dus vooral bedoeld om te gebruiken voor veel voorkomende handelingen of voor complexe handelingen. Door van een macro gebruik te maken kan de efficiency verhoogd en de kans op fouten verminderd worden.\n\nEenvoudige macro's welke uit een aantal achter elkaar uitgevoerde handelingen bestaan, kunnen met de ingebouwde macrorecorder worden opgenomen. Complexe macro's worden geprogrammeerd in de programmeertaal VBA. Alleen eenvoudige macro's komen hier aan bod, hiervoor heb je geen programmeerkennis nodig.\n\n::: callout-note\nDe taal waarin de Excel macro's geschreven worden is Visual Basic for Applications (VBA). De opdrachten en functies van de macro worden in een Visual Basic module opgeslagen. En met de Visual Basic editor kun je macro's bewerken, macro's van de ene module naar de andere kopiëren, macro's tussen verschillende werkmappen kopiëren en de modules en macro's een andere naam een andere naam geven.\n:::\n\n## Tab Ontwikkelaars {#sec-tab-developer}\n\nOm macro's op te kunnen nemen, te bewerken en uit te voeren moet het tabblad [Ontwikkelaars]{.uicontrol} zichtbaar gemaakt worden.\n\nEen aantal functies van Excel, waaronder die voor Macro's en VBA, zitten onder het tabblad [Ontwikkelaars]{.uicontrol}. Dit tabblad wordt bij de installatie van Excel standaard niet getoond en zal dus eerst zichtbaar gemaakt moeten worden. Dit is een eenmalige actie.\n\n::: callout-warning\nControleer eerst of op het lint de tab [Ontwikkelaars]{.uicontrol} aanwezig is. Zoja, dan kun je deze taak overslaan.\n\n![Tab ontwikkelaars.](images/macro/tab-developer.png){#fig-tab-developer}\n:::\n\n::: {#prp-tab-developer}\n1.  Kies [Bestand \\> Opties \\> Lint aanpassen]{.uicontrol}.\n\n![Opties Excel voor weergeven tabblad ontwikkelaars.](images/common/excel-options-developertab.png){#fig-excel-options-developertab}\n\n2.  Selecteer onder Hoofdtabbladen [Ontwikkelaars]{.uicontrol} en klik op [OK]{.uicontrol}.\n\nOp het lint moet nu het tabblad [Ontwikkelaars]{.uicontrol} (zie @fig-tab-developer) zichtbaar zijn.\n:::\n\n## Macro-beveiligingsinstellingen {#sec-macros-security}\n\nMacro's kunnen worden gebruikt voor kwaadaardige doeleinden, zoals het installeren van een virus. Dit kan worden geblokkeerd met de beveiligingsinstellingen. Echter als de instellingen te hoog staan, kun je geen macro's uitvoeren en als ze te laag staan ben je niet beschermd. Geen van beide is een goede optie. Een goed compromis is de instelling die je steeds de mogelijkheid geeft om te beslissen of je macro's wilt toestaan of niet. Dit is ook de standaardinstelling.\n\n**Instellingen wijzigen**\n\nWanneer je de beveiligingsinstellingen van macro's wilt bekijken of wijzigen dan moet je klikken op [tab Ontwikkelaars \\> Macrobeveiliging (groep Programmacode)]{.uicontrol}.\n\n![Opdrachtknop macrobeveiling op het lint.](images/macro/macro-security-button.png){#fig-macro-security-button}\n\nDan verschijnt het dialoogvenster ***Vertrouwenscentrum***.\n\n![Macro instellingen in het vertrouwenscentrum.](images/macro/trust-center-macro-settings.png){#fig-trust-center-macro-settings}\n\n| Instelling                                          | Toelichting                                                                                                                                                                                                                                                                                                                                                           |\n|-----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Macro's zonder meldingen uitschakelen               | Kies deze optie wanneer je macro's niet wilt toestaan. Alle macro's in documenten worden uitgeschakeld, evenals de beveiligingswaarschuwingen over macro's. Bestanden die macro's bevatten die je wel vertrouwt, kun je eventueel opslaan op een vertrouwde locatie. Bestanden op vertrouwde locaties worden uitgevoerd zonder controle door het beveiligingssysteem. |\n| Macro's met meldingen uitschakelen                  | Dit is de standaardinstelling en de beste keuze. Met deze instelling krijg je een melding waarbij je kunt kiezen om macro's macro's wel of niet uit te voeren.                                                                                                                                                                                                        |\n| Macro's uitschakelen, behalve digitaal ondertekende | De maker van een macro kan deze digitaal ondertekenen. Wanneer je deze maker dan als een vertrouwde instantie aanmerkt dan wordt de macro zonder waarschuwingen uitgevoerd. Alle niet-ondertekende macro´s worden zonder melding uitgeschakeld.                                                                                                                       |\n| Macro's inschakelen                                 | Kies deze optie wanneer je alle macro's wilt uitvoeren. Deze optie wordt niet aanbevolen want hierdoor ben je niet meer beschermd tegen schadelijke macro's.                                                                                                                                                                                                          |\n\n: Overzicht Macro instellingen. {#tbl-macro-security-settings tbl-colwidths=\"\\[25,75\\]\"}\n\n## Macro's opnemen {#sec-macros-recording}\n\nEenvoudige macro's kunnen gemaakt worden door de handelingen op te nemen met de ingebouwde **macrorecorder**. Na het starten van de recorder worden alle handelingen opgenomen en op de achtergrond omgezet in VBA code. Dit gaat door totdat de recorder gestopt wordt.\n\n::: callout-note\nOm een goed werkende macro te krijgen is het belangrijk om eerst de te verrichten handelingen zonder opname uit te voeren en in volgorde te noteren. Dit script kun je daarna gebruiken om de handelingen met de macrorecorder op te nemen.\n:::\n\nDe knop waarmee je het opnemen van macro's kunt starten zit op de [tab Ontwikkelaars]{.uicontrol} in de groep [Programmacode]{.uicontrol}, zie @fig-tab-developer.\n\nWanneer op deze knop geklikt wordt om de opname van een macro te starten verschijnt eerst een dialoogvenster waarin een aantal eigenschappen van de macro kunnen worden ingevuld.\n\n![Dialoogvenster Macro opnemen.](images/macro/record-macro-dialogbox.png){#fig-record-macro-dialogbox}\n\n**Macronaam**\n\nElke macro moet verplicht een naam hebben. Standaard vult Excel hiervoor in de tekst `Macro` gevolgd door een cijfer. Deze naam kun je wijzigen door hiervoor een andere naam in te typen.\n\nHet eerste teken van de macronaam moet verplicht een letter zijn. Daarna kun je andere tekens gebruiken zoals letters, cijfers of het onderstrepingsteken. Spaties zijn in een macronaam niet toegestaan. Geef macro's altijd passende namen waaruit blijkt wat de macro gaat doen. Het onderstrepingsteken kan als scheidingsteken tussen woorden gebruikt worden.\n\n**Sneltoets**\n\nMacro's kun je starten via het menu, maar desgewenst ook via zogenaamde sneltoetsen. Dit zijn toetscombinaties van de [CTRL]{.uicontrol} toets met een lettertoets. Wanneer je aan de macro een sneltoets wilt toewijzen dan kun je de te gebruiken letter in het vak typen. Zet je daar bijvoorbeeld de letter A in, dan is de toetscombinatie [CTRL A]{.uicontrol} de sneltoets waarmee je de macro kunt starten.\n\nHet is niet verplicht om aan een macro een sneltoets toe te wijzen, maar voor veel gebruikte macro's kan dit wel handig zijn.\n\n**Macro opslaan in**\n\nDe plekken waar een macro kan worden opgeslagen zijn:\n\n-   Deze werkmap\n-   Nieuwe werkmap\n-   Persoonlijke Macrowerkmap\n\nHet is wel belangrijk om hier van te voren goed over na te denken. Wanneer de macro alleen in de actieve werkmap gebruikt gaat worden, dan kies je voor [Deze werkmap]{.uicontrol}. Moet de macro ook in andere werkmappen gebruikt worden, dus eigenlijk altijd beschikbaar zijn, dan is [Persoonlijke Macrowerkmap]{.uicontrol} de beste keuze. De keuze [Nieuwe werkmap]{.uicontrol} wordt eigenlijk nooit gebruikt.\n\nJe moet de opslagplek altijd specificeren. De standaardwaarde is [Deze werkmap]{.uicontrol}.\n\n**Beschrijving**\n\nHet is aan te bevelen om een korte beschrijving te geven van wat de macro doet. Bij het maken van de macro weet je dit wel, maar enige tijd later ben je het misschien vergeten. Het is niet verplicht om een beschrijving op te geven.\n\n::: callout-note\nAlle gemaakte keuzes kunnen in een later stadium altijd gewijzigd worden.\n:::\n\n## Macro Celopmaak {#sec-macros-cellformat}\n\n*Informatiebehoefte*\n\nMaak een macro die een geselecteerde cel opmaakt met het lettertype Comic Sans MS, vet, cursief, 16 pt en rood. Verder moet de kolombreedte aangepast worden aan de breedte van de tekst in de cel. De naam van de macro moet worden [Celopmaak]{.varname}.\n\n::: {#prp-macros-cellformat-record}\n**Macro opnemen**\n\n1.  Begin met een nieuwe werkmap en voer in een willekeurige cel een tekst in.\n\n2.  Selecteer de cel met de tekst.\n\n3.  Kies [tab Ontwikkelaars \\> Macro opnemen (groep Programmacode)]{.uicontrol}.\n\n4.  Geef in het dialoogvenster de naam voor de macro en voeg een beschrijving toe.\n\n![Eigenschappen macro Celopmaak.](images/macro/record-macro-cellformat.png){#fig-record-macro-cellformat}\n\n5.  Klik op [OK]{.uicontrol}.\n\n6.  Voer de volgende acties uit op de geselecteerde cel: [Rechter muisklik \\> Celeigenschappen \\> tab Lettertype]{.uicontrol} en stel het volgende in:\n\n    -   Lettertype: Comic Sans MS\n    -   Tekenstijl: Vet en cursief\n    -   Punten: 16\n    -   Kleur: Rood\n\n7.  Kies tab [Start \\> Opmaak (groep Cellen) \\> Kolombreedte AutoAanpassen]{.uicontrol}.\n\n8.  Kies tab [Ontwikkelaars \\> Opname stoppen (groep Programmacode)]{.uicontrol}\n\n![Knop om te stoppen met het opnemen van de macro.](images/macro/record-macro-stop.png){#fig-record-macro-stop}\n:::\n\nNu kan de macro getest worden op de juiste werking.\n\n::: {#prp-macros-cellformat-test}\n**Macro testen**\n\n1.  Voer in een andere cel een tekst in en selecteer deze cel.\n\n2.  Kies [tab Ontwikkelaars \\> Macro's (groep Programmacode)]{.uicontrol}.\n\n3.  Selecteer macro [Celopmaak]{.uicontrol} en klik [Uitvoeren]{.uicontrol}.\n\n![Dialoogvenster macro celopmaak.](images/macro/macro-cellformat-run.png){#fig-macro-cellformat-run}\n\n4.  Controleer of de cel correct is opgemaakt.\n\n5.  Sla de werkmap op als [Excel-werkmap met macro's (\\*.xslm)]{.uicontrol} op onder de naam `Celopmaak.xlsm`.\n\n![Opslaan van het werkblad met macro's.](images/macro/macro-cellformat-save.png){#fig-macro-cellformat-save}\n:::\n\n::: callout-warning\nWanneer je een werkmap met macro's wilt opslaan, dan probeert Excel deze standaard op te slaan als een Excel-werkmap met de extensie `.xlsx`. Echter in dit formaat kunnen geen macro's worden opgeslagen. Je moet dit zelf wijzigen in een **Excel-werkmap met macro's** met de extensie `.xlsm`.\n:::\n\n## Wijzigen van een macro {#sec-macros-cellformat-editing}\n\nOm deze taak uit te kunnen voeren is het nodig dat de macro \\[Celopmaak\\]{varname} in @prp-macros-cellformat-test gemaakt is.\n\nEen eenmaal gemaakte macro kan gewijzigd worden zonder de macro weer helemaal opnieuw op te nemen. Zowel de opties van de macro als de programmacode kunnen bekeken en gewijzigd worden.\n\n*Informatiebehoefte*\n\nBreng de volgende wijzigingen aan in de macro [Celopmaak]{.varname}:\n\n-   Ken sneltoets [Control t]{.uicontrol} toe.\n-   Wijzig lettergrootte in 18 pt.\n\n::: {#prp-macros-cellformat-editing}\nGa verder met het bestand uit @prp-macros-cellformat-test.\n\n1.  Open indien nodig het bestand.\n\n2.  Kies tab [Ontwikkelaars \\> Macro's (groep Programmacode)]{.uicontrol}.\n\nJe krijgt nu weer het dialoogvenster met beschikbare macro's, zie @fig-macro-cellformat-run.\n\n3.  Selecteer macro [Celopmaak]{.varname} en kies [Opties]{.uicontrol}.\n\n![Opties voor macro celopmaak.](images/macro/macro-cellformat-options.png){#fig-macro-cellformat-options}\n\n4.  Zet in het vakje voor de sneltoets de letter `t` en wijzig in de beschrijving 16pt in 18pt. Klik daarna op [OK]{.uicontrol}.\n\n5.  Kies nu in het dialoogvenster voor [Bewerken]{.uicontrol}.\n\nEen nieuw venster Microsoft Visual Basic verschijnt nu met in het codescherm de programmacode van de macro. In deze code kom je op twee plaatsen tegen dat de tekstgrootte 16 wordt:\n\n-   `Maakt cel op in Comic Sans, 16pt, vet, cursief en rood`\n-   `.Size = 16`\n\n6.  Wijzig dit op beide plaatsen in `18`.\n\n7.  Sluit het venster Microsoft Visual Basic via de sluitknop in de rechterbovenhoek.\n\n8.  Test de macro op een cel met tekst via de sneltoets [Ctrl t]{.uicontrol}.\n:::\n\n## Opdrachtknop maken {#sec-macros-cellformat-commandbutton}\n\nJe kunt een macro op een van de volgende manieren uitvoeren:\n\n-   Via het menu [tab Ontwikkelaars \\> Macro's \\> macro selecteren \\> Uitvoeren]{.uicontrol}.\n-   Via een sneltoets wanneer er eentje aan de macro is toegewezen.\n-   Via een opdrachtknop voor de macro.\n\nIn deze taak wordt voor de eerder gemaakte macro [Celopmaak]{.varname} een opdrachtknop op het werkblad gemaakt.\n\n::: {#prp-macros-cellformat-commandbutton}\nGa verder met het bestand uit @prp-macros-cellformat-editing.\n\n1.  Open indien nodig het bestand.\n\n2.  Kies [tab Ontwikkelaars \\> Invoegen (groep Besturingselementen)]{.uicontrol}.\n\n3.  Klik op het besturingselement [Knop (formulierbesturingselement)]{.uicontrol}.\n\n![Besturingselementen, de gemarkeerde is de Knop (formulierbesturingselement).](images/macro/form-controls.png){#fig-form-controls}\n\nDe cursor verandert nu in een `+` waarmee je een rechthoek voor de knop op het werkblad kunt tekenen.\n\n4.  Druk de linkermuisknop in en teken hiermee ergens op het werkblad een rechthoek voor de gewenste afmetingen van de knop. Laat daarna de linkermuisknop los. Het dialoogvenster ***Macro toewijzen aan object*** verschijnt dan.\n\n![Macro celopmaak koppelen aan knop.](images/macro/macro-cellformat-assign.png){#fig-macro-cellformat-assign}\n\n5.  Selecteer macro [Celopmaak]{.uicontrol} en klik op [OK]{.uicontrol}.\n\nDe getekende rechthoek verandert in een knop met daarop een tekst als `Knop 1`.\n\n6.  Selecteer de tekst op de knop en wijzig deze in een toepasselijker tekst, bijvoorbeeld `Cel opmaken`.\n\n![Opdrachtknop, links de standaardknop, rechts met de gewijzigde tekst op de knop.](images/macro/macro-cellformat-button.png){#fig-macro-cellformat-button}\n\n7.  Hef de selectie van de knop op door op een willekeurige plek op het werkblad te klikken.\n\n8.  Test de werking van de macro op een cel met tekst via de opdrachtknop.\n:::\n\n## Tips {#sec-macros-tips}\n\n### Relatieve verwijzingen {#sec-macros-tips-references}\n\nIn opgenomen macro's wordt standaard gebruikgemaakt van absolute celverwijzingen. Dit houdt in dat de exacte locaties van cellen, rijen en kolommen in de programmacode van de macro worden opgenomen. De macro werkt dan altijd op dezelfde adressen.\n\nWanneer je relatieve verwijzingen in de macro wilt gebruiken dan moet je klikken op de knop [Relatieve verwijzingen]{.uicontrol}.\n\n![Relatieve verwijzingen in macro's.](images/macro/record-macro-relative-references.png){#fig-record-macro-relative-references}\n\n::: callout-warning\nDeze instelling blijft actief totdat je de instelling ongedaan maakt door weer op deze knop te klikken.\n:::\n\n### Macro's verwijderen {#sec-macros-tips-deleting}\n\nMacro's kunnen verwijderd worden via [tab Ontwikkelaars \\> Macro's (groep Programmacode) \\> Macro selecteren \\> Verwijderen]{.uicontrol}.\n\n## Opgaven {#sec-macros-exercises}\n\n::: {#exr-macr001}\n**Achtergrondkleur (macr001)**\n\nNeem een macro op die de actieve cel een grijze achtergrondkleur geeft.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Antwoord</button>\n Een mogelijke oplossing.\n\n```         \nSub Achtergrond_Grijs()\n'\n' Lichtgrijze achtergrond voor cel\n'\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = -0.14996795556505\n        .PatternTintAndShade = 0\n    End With\nEnd Sub\n```\n\n\n</div>\n\n:::\n:::\n\n::: {#exr-macr002}\n**Procentuele opmaak (macr002)**\n\nNeem een macro op met de naam ProcentOpmaak die een getal opmaakt als procenten met 1 decimaal en het getal in de cel centreert.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Antwoord</button>\n Een mogelijke oplossing.\n\n```         \nSub Procentopmaak()\n'\n' Getal als percentage met 1 dec. en horizontaal gecentreerd\n'\n    Selection.NumberFormat = \"0.0%\"\n    With Selection\n        .HorizontalAlignment = xlCenter\n    End With\nEnd Sub\n```\n\n\n</div>\n\n:::\n:::\n\n::: {#exr-macr003}\n**Opmaak cel A1 (macr003)**\n\nNeem een macro op die het volgende uitvoert:\n\n-   Rijhoogte rij 1 wordt 18\n-   Kolombreedte van de eerste kolom wordt 3\n-   Tekst in cel A1 wordt Tahoma 14, vet, blauwe kleur\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Antwoord</button>\n Een mogelijke oplossing.\n\n```         \nSub OpmaakA1()\n'\n' opgave macr003\n'\n    Rows(\"1:1\").Select\n    Selection.RowHeight = 18\n    Columns(\"A:A\").Select\n    Selection.ColumnWidth = 3\n    Range(\"A1\").Select\n    With Selection.Font\n        .Name = \"Tahoma\"\n        .Size = 14\n        .Bold = True\n        .Color = -4165632\n    End With\nEnd Sub\n```\n\n\n</div>\n\n:::\n:::\n\n::: {#exr-macr004}\n**Rasterlijnen afdrukken (macr004)**\n\nNeem een macro op die er voor zorgt dat bij het afdrukken ook de rasterlijnen worden afgedrukt.\n\n::: callout-note\nDeze eigenschap is te vinden bij [tab Pagina-indeling \\> Pagina-instelling \\> tab Blad]{.uicontrol}.\n:::\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Antwoord</button>\n Een mogelijke oplossing.\n\n```         \nSub Print_Rasterlijnen()\n'\n' opgave macr004\n'\n    With ActiveSheet.PageSetup\n        .PrintGridlines = True\n    End With\nEnd Sub\n```\n\n\n</div>\n\n:::\n:::\n",
    "supporting": [
      "16-macro_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}